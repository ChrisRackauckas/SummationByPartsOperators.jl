# order 2
h = [1//2, 1, 1, 1, 1, 1, 1]
e = [1//1, 0, 0, 0, 0, 0, 0]
d1 = [-3//2, 2, -1//2, 0, 0, 0, 0]
d2 = [1//1, -2, 1, 0, 0, 0, 0]
d3 = [-1//1, 3, -3, 1, 0, 0, 0]
H = Diagonal(h)

q1 = [0 1//2 0 0 0 0 0]
q2 = [-1//2 0 1//2 0 0 0 0]
q3 = [0 -1//2 0 1//2 0 0 0]
q4 = [0 0 -1//2 0 1//2 0 0]
q5 = [0 0 0 -1//2 0 1//2 0]
q6 = [0 0 0 0 -1//2 0 1//1]
q7 = [0 0 0 0 0 -1//2 0]
Q = vcat(q1, q2, q3, q4, q5, q6, q7)

m1 = [1//1 -1 0 0 0 0 0]
m2 = [m1[2] 2 -1 0 0 0 0]
m3 = [0 -1 2 -1 0 0 0]
m4 = [0 0 -1 2 -1 0 0]
m5 = [0 0 0 -1 2 -1 0]
m6 = [0 0 0 0 -1 2 -1]
m7 = [0 0 0 0 0 -1 2 ]
M = vcat(m1, m2, m3, m4, m5, m6, m7)

r1 = [0 -13//16 7//8 -1//16 0 0 0]
r2 = [-r1[2] 0 -23//16 5//8 0 0 0]
r3 = [-r1[3] -r2[3] 0 -17//16 1//2 0 0]
r4 = [0 -1//2 2//2 0 -2//2 1//2 0]
r5 = [0 0 -1//2 2//2 0 -2//2 1//2]
r6 = [0 0 0 -1//2 2//2 0 -2//2]
r7 = [0 0 0 0 -1//2 2//2 0]
R = vcat(r1, r2, r3, r4, r5, r6, r7)

n1 = [13//10 -12//5 9//10 1//5 0 0 0]
n2 = [n1[2] 26//5 -16//5 2//5 0 0 0]
n3 = [n1[3] n2[3] 47//10 -17//5 1 0 0]
n4 = [n1[4] n2[4] n3[4] -29//5 -4 1 0]
n5 = [0 0 1//1 -4 6 -4 1]
n6 = [0 0 0 1//1 -4 6 -4]
n7 = [0 0 0 0 1//1 -4 6]
N = vcat(n1, n2, n3, n4, n5, n6, n7)

D1 = H \ (Q - 1//2*e*e'); display(D1)
D2 = H \ (-M - e*d1'); display(D2)
D3 = H \ (R + 1//2*d1*d1' - e*d2'); display(D3)
D4 = H \ (N - e*d3' + d1*d2'); display(D4)

x=1//1:length(h)
ks = 0:5
for k in ks
    u=x.^k
    println("k = ", k)
    println(D1*u - k*x.^(k-1))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(D2*u - k*(k-1)*x.^(k-2))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(D3*u - k*(k-1)*(k-2)*x.^(k-3))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(D4*u - k*(k-1)*(k-2)*(k-3)*x.^(k-4))
end

# order 4
h = [35809//100800,
    13297//11200,
    5701//5600,
    45109//50400,
    35191//33600,
    33503//33600,
    1, 1, 1, 1]
e = [1//1, 0, 0, 0, 0, 0, 0, 0, 0, 0]
d1 = [-11//6, 18//6, -9//6, 2//6, 0, 0, 0, 0, 0, 0]
d2 = [2//1, -5, 4, -1, 0, 0, 0, 0, 0, 0]
d3 = [-1//1, 3, -3, 1, 0, 0, 0, 0, 0, 0]

q1 = [0 526249//907200 -10819//777600 -50767//907200 -631//28800 91//7776 0 0 0 0]
q2 = [-q1[2] 0 1421209//2721600 16657//201600 -8467//453600 -33059//5443200 0 0 0 0]
q3 = [-q1[3] -q2[3] 0 631187//1360800 400139//5443200 -8789//302400 0 0 0 0]
q4 = [-q1[4] -q2[4] -q3[4] 0 496403//907200 -308533//5443200 0 0 0 0]
q5 = [-q1[5] -q2[5] -q3[5] -q4[5] 0 1805647//2721600 -1//12 0 0 0]
q6 = [-q1[6] -q2[6] -q3[6] -q4[6] -q5[6] 0 8//12 -1//12 0 0]
q7 = [0 0 0 0 1//12 -8//12 0 8//12 -1//12 0]
q8 = [0 0 0 0 0 1//12 -8//12 0 8//12 -1//12]
q9 = [0 0 0 0 0 0 1//12 -8//12 0 8//12]
q10 = [0 0 0 0 0 0 0 1//12 -8//12 0]

r1 = [0 -88471//67200 58139//33600 -1167//2800 -89//11200 7//640 0 0 0 0]
r2 = [-r1[2] 0 -43723//16800 46783//33600 -191//3200 -1567//33600 0 0 0 0]
r3 = [-r1[3] -r2[3] 0 -4049//2400 29083//33600 -71//1400 0 0 0 0]
r4 = [-r1[4] -r2[4] -r3[4] 0 -8591//5600 10613//11200 -1//8 0 0 0]
r5 = [-r1[5] -r2[5] -r3[5] -r4[5] 0 -108271//67200 8//8 -1//8 0 0]
r6 = [-r1[6] -r2[6] -r3[6] -r4[6] -r5[6] 0 -13//8 8//8 -1//8 0]
r7 = [0 0 0 1//8 -8//8 13//8 0 -13//8 8//8 -1//8]
r8 = [0 0 0 0 1//8 -8//8 13//8 0 -13//8 8//8]
r9 = [0 0 0 0 0 1//8 -8//8 13//8 0 -13//8]
r10 = [0 0 0 0 0 0 1//8 -8//8 13//8 0]

H = Diagonal(h)
Q = vcat(q1, q2, q3, q4, q5, q6, q7, q8, q9, q10)
#M = vcat(m1', [-1 2 -1 0 0], [0 -1 2 -1 0], [0 0 -1 2 -1], [0 0 0 -1 2])
R = vcat(r1, r2, r3, r4, r5, r6, r7, r8, r9, r10)
#N = vcat(n1', n2', n3', n4', [0 0 1 -4 6])

D1 = H \ (Q - 1//2*e*e'); display(D1)
#D2 = H \ (-M - e*d1'); display(D2)
D3 = H \ (R + 1//2*d1*d1' - e*d2'); display(D3)
#D4 = H \ (N - e*d3' + d1*d2'); display(D4)
