# order 2
h = [1//2, 1, 1, 1, 1, 1, 1]
e = [1//1, 0, 0, 0, 0, 0, 0]
d1 = [-3//2, 2, -1//2, 0, 0, 0, 0]
d2 = [1//1, -2, 1, 0, 0, 0, 0]
d3 = [-1//1, 3, -3, 1, 0, 0, 0]
H = Diagonal(h)

q1 = [0 1//2 0 0 0 0 0]
q2 = [-1//2 0 1//2 0 0 0 0]
q3 = [0 -1//2 0 1//2 0 0 0]
q4 = [0 0 -1//2 0 1//2 0 0]
q5 = [0 0 0 -1//2 0 1//2 0]
q6 = [0 0 0 0 -1//2 0 1//1]
q7 = [0 0 0 0 0 -1//2 0]
Q = vcat(q1, q2, q3, q4, q5, q6, q7)

m1 = [1//1 -1 0 0 0 0 0]
m2 = [m1[2] 2 -1 0 0 0 0]
m3 = [0 -1 2 -1 0 0 0]
m4 = [0 0 -1 2 -1 0 0]
m5 = [0 0 0 -1 2 -1 0]
m6 = [0 0 0 0 -1 2 -1]
m7 = [0 0 0 0 0 -1 2 ]
M = vcat(m1, m2, m3, m4, m5, m6, m7)

r1 = [0 -13//16 7//8 -1//16 0 0 0]
r2 = [-r1[2] 0 -23//16 5//8 0 0 0]
r3 = [-r1[3] -r2[3] 0 -17//16 1//2 0 0]
r4 = [0 -1//2 2//2 0 -2//2 1//2 0]
r5 = [0 0 -1//2 2//2 0 -2//2 1//2]
r6 = [0 0 0 -1//2 2//2 0 -2//2]
r7 = [0 0 0 0 -1//2 2//2 0]
R = vcat(r1, r2, r3, r4, r5, r6, r7)

n1 = [13//10 -12//5 9//10 1//5 0 0 0]
n2 = [n1[2] 26//5 -16//5 2//5 0 0 0]
n3 = [n1[3] n2[3] 47//10 -17//5 1 0 0]
n4 = [n1[4] n2[4] n3[4] -29//5 -4 1 0]
n5 = [0 0 1//1 -4 6 -4 1]
n6 = [0 0 0 1//1 -4 6 -4]
n7 = [0 0 0 0 1//1 -4 6]
N = vcat(n1, n2, n3, n4, n5, n6, n7)

D1 = H \ (Q - 1//2*e*e'); display(D1)
D2 = H \ (-M - e*d1'); display(D2)
D3 = H \ (R + 1//2*d1*d1' - e*d2'); display(D3)
D4 = H \ (N - e*d3' + d1*d2'); display(D4)

x=1//1:length(h)
ks = 0:5
for k in ks
    u=x.^k
    println("k = ", k)
    println(D1*u - k*x.^(k-1))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(D2*u - k*(k-1)*x.^(k-2))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(D3*u - k*(k-1)*(k-2)*x.^(k-3))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(D4*u - k*(k-1)*(k-2)*(k-3)*x.^(k-4))
end

# order 4
h = [35809//100800,
    13297//11200,
    5701//5600,
    45109//50400,
    35191//33600,
    33503//33600,
    1, 1, 1, 1]
e = [1//1, 0, 0, 0, 0, 0, 0, 0, 0, 0]
d1 = [-11//6, 18//6, -9//6, 2//6, 0, 0, 0, 0, 0, 0]
d2 = [2//1, -5, 4, -1, 0, 0, 0, 0, 0, 0]
d3 = [-1//1, 3, -3, 1, 0, 0, 0, 0, 0, 0]
H = Diagonal(h)

q1 = [0 526249//907200 -10819//777600 -50767//907200 -631//28800 91//7776 0 0 0 0]
q2 = [-q1[2] 0 1421209//2721600 16657//201600 -8467//453600 -33059//5443200 0 0 0 0]
q3 = [-q1[3] -q2[3] 0 631187//1360800 400139//5443200 -8789//302400 0 0 0 0]
q4 = [-q1[4] -q2[4] -q3[4] 0 496403//907200 -308533//5443200 0 0 0 0]
q5 = [-q1[5] -q2[5] -q3[5] -q4[5] 0 1805647//2721600 -1//12 0 0 0]
q6 = [-q1[6] -q2[6] -q3[6] -q4[6] -q5[6] 0 8//12 -1//12 0 0]
q7 = [0 0 0 0 1//12 -8//12 0 8//12 -1//12 0]
q8 = [0 0 0 0 0 1//12 -8//12 0 8//12 -1//12]
q9 = [0 0 0 0 0 0 1//12 -8//12 0 8//12]
q10 = [0 0 0 0 0 0 0 1//12 -8//12 0]
Q = vcat(q1, q2, q3, q4, q5, q6, q7, q8, q9, q10)

m1 = [2386127//2177280 -515449//453600 -10781//777600 61567//1360800 6817//403200 -1069//136080 0 0 0 0]
m2 = [m1[2] 4756039//2177280 -1270009//1360800 -3751//28800 3067//680400 119459//10886400 0 0 0 0]
m3 = [m1[3] m2[3] 111623//60480 -555587//680400 -551339//5443200 8789//453600 0 0 0 0]
m4 = [m1[4] m2[4] m3[4] 1025327//544320 -464003//453600 222133//5443200 0 0 0 0]
m5 = [m1[5] m2[5] m3[5] m4[5] 5074159//2177280 -1784047//1360800 1//12 0 0 0]
m6 = [m1[6] m2[6] m3[6] m4[6] m5[6] 1812749//725760 -16//12 1//12 0 0]
m7 = [0 0 0 0 1//12 -16//12 30//12 -16//12 1//12 0]
m8 = [0 0 0 0 0 1//12 -16//12 30//12 -16//12 1//12]
m9 = [0 0 0 0 0 0 1//12 -16//12 30//12 -16//12]
m10 = [0 0 0 0 0 0 0 1//12 -16//12 30//12]
M = vcat(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10)

r1 = [0 -88471//67200 58139//33600 -1167//2800 -89//11200 7//640 0 0 0 0]
r2 = [-r1[2] 0 -43723//16800 46783//33600 -191//3200 -1567//33600 0 0 0 0]
r3 = [-r1[3] -r2[3] 0 -4049//2400 29083//33600 -71//1400 0 0 0 0]
r4 = [-r1[4] -r2[4] -r3[4] 0 -8591//5600 10613//11200 -1//8 0 0 0]
r5 = [-r1[5] -r2[5] -r3[5] -r4[5] 0 -108271//67200 8//8 -1//8 0 0]
r6 = [-r1[6] -r2[6] -r3[6] -r4[6] -r5[6] 0 -13//8 8//8 -1//8 0]
r7 = [0 0 0 1//8 -8//8 13//8 0 -13//8 8//8 -1//8]
r8 = [0 0 0 0 1//8 -8//8 13//8 0 -13//8 8//8]
r9 = [0 0 0 0 0 1//8 -8//8 13//8 0 -13//8]
r10 = [0 0 0 0 0 0 1//8 -8//8 13//8 0]
R = vcat(r1, r2, r3, r4, r5, r6, r7, r8, r9, r10)

n1 = [4596181//1814400 -10307743//1814400 160961//43200 -535019//907200 109057//1814400 -29273//604800 0 0 0 0]
n2 = [n1[2] 8368543//604800 -9558943//907200 2177057//907200 -11351//86400 204257//1814400 0 0 0 0]
n3 = [n1[3] n2[3] 4938581//453600 -786473//151200 1141057//907200 -120619//907200 0 0 0 0]
n4 = [n1[4] n2[4] n3[4] 3146581//453600 -4614143//907200 24587//14400 -1//6 0 0 0]
n5 = [n1[5] n2[5] n3[5] n4[5] 185709//22400 -11293343//1814400 12//6 -1//6 0 0]
n6 = [n1[6] n2[6] n3[6] n4[6] n5[6] 16787381//1814400 -39//6 12//6 -1//6 0]
n7 = [0 0 0 -1//6 12//6 -39//6 56//6 -39//6 12//6 -1//6]
n8 = [0 0 0 0 -1//6 12//6 -39//6 56//6 -39//6 12//6]
n9 = [0 0 0 0 0 -1//6 12//6 -39//6 56//6 -39//6]
n10 = [0 0 0 0 0 0 -1//6 12//6 -39//6 56//6]
N = vcat(n1, n2, n3, n4, n5, n6, n7, n8, n9, n10)

D1 = H \ (Q - 1//2*e*e'); display(D1)
D2 = H \ (-M - e*d1'); display(D2)
D3 = H \ (R + 1//2*d1*d1' - e*d2'); display(D3)
D4 = H \ (N - e*d3' + d1*d2'); display(D4)

x=1//1:length(h)
ks = 0:7
for k in ks
    u=x.^k
    println("k = ", k)
    println(Float64.(D1*u - k*x.^(k-1)))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(Float64.(D2*u - k*(k-1)*x.^(k-2)))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(Float64.(D3*u - k*(k-1)*(k-2)*x.^(k-3)))
end
for k in ks
    u=x.^k
    println("k = ", k)
    println(Float64.(D4*u - k*(k-1)*(k-2)*(k-3)*x.^(k-4)))
end
